<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>

<muclient>
<plugin
   name="SK_CombatHighlighter"
   author="Aello"
   id="11111141111111111111111C"
   language="Lua"
   purpose="Highlights and display notifications"
   date_written="2018-05-12 10:45:35"
   requires="4.94"
   version="1.0"
   >
<description trim="y">
<![CDATA[
Combat Notification and Highlighting alerts

]]>
</description>

</plugin>

<!--  Triggers  -->
<triggers>

  
  <trigger
   custom_colour="17"
   enabled="y"
   expand_variables="y"
   ignore_case="y"
   keep_evaluating="y"
   match="@target"
   regexp="y"
   repeat="y"
   sequence="90"
   other_text_colour="red"
  >
  </trigger>
  <trigger
   enabled="y"
   match="^(?:\> )*(Your spirit companions leave you.|You feel less protected.|Your clothing feels soft again.|You feel less righteous.|Your ward dissolves.|Your skin feels soft again.|Your rage ebbs.|You slowly float to the ground.|The bubble of airy water collapses.|You are no longer invisible.|Your force shield shimmers then fades away.|Your spell ward dissolves.|You feel yourself slow down.|You feel weaker.|You retain your stance.|Your pulse slows to normal.|You start to (pray|chant).|(.*) starts to (pray|chant).|You regain your footing.|You need to regain your feet first.|You regain consciousness and rise unsteadily to your feet.|(.*) regains consciousness and rises unsteadily to (its|his|her) feet.|(.*) starts to concentrate.|(.*) utters the words, (.*).|(.*) glows with mystical energy!|(.*) tries to disarm you, but fails.|(.*) disarms you and sends your weapon flying!|(.*) regains (his|her|its) footing.|There is too much chaos going on right now.|Your spirit feels more settled.|Your body feels less fatigued.|The ether wire phases partially out of existence. |You feel level-headed again.|Your skin feels soft again.|You fight a battle of inner will.|You thunder forth a tremendous rallying cry!|(.*) thunders forth a tremendous rallying cry!|(.*) sounds the retreat!|You assume (a|an) (neutral|defensive|aggressive) stance.|You trip (.*) and (he|she|it) goes down!|You are ready to summon another treant.|You feel able to conjure another elemental.|Yippee! It worked.|The white aura around your body fades.|You feel your pulse slow down.|Pink flames surround (.*).|Better stand up first.|Your elemental flickers slightly.|That group is in the thick of battle.|Your mount is now rested and recharged.|You no longer see in the dark.|A spirit steed glows brightly and vanishes back to the upper planes.|Your spirit companion flickers slightly.|Both of (its|his|her) legs are already mangled.|Your methodical attack breaks down as (.*) taunts you.|Your bash misses and you fall flat on your face!|You slam into (.*) and send (him|her|it) sprawling!|You evade (.*)'s bash and (he|she|it) falls flat on (his|her|its) face.|(.*) slams into (.*) and sends (.*) sprawling!|(.*)'s bash misses and (he|she|it) falls flat on (his|her|its) face.|You try to trip (.*) but end up tripping yourself!|(.*) tries to trip (.*) but ends up tripping (himself|herself|itself)!|(.*) trips you and you go down!|(.*) trips (.*) sending (him|her|it) to the ground.|(.*) appears to be blinded.|(.*) is blinded by the dirt in (his|her|its) eyes!|(.*) sly taunts cause (.*) to charge (him|her|it) in fury.|(.*) attempts to taunt (.*), but just sounds lame.|(.*) goes crazy as (.*) begins taunting (him|her|it) mercilessly.|(.*) tries to taunt you. Maybe you should teach (him|her|it) a lesson\?|Your sly taunts cause (.*) to charge you in fury.|(.*) is standing behind your victim, blocking your attack.|You are too busy defending yourself.|(.*) is still hyper-alert from combat.|(His|Her|Its) weapon won't budge!|You fail to disarm (.*).|(.*) disarms you but you secure your weapon.|You disarm (.*) and send [hisherits]+ weapon flying!|(.*) disarms (.*) and sends [hisherits]+ weapon flying!|You feel unclean.|(.*) looks very uncomfortable.|You disarm (.*)!|(.*) disarms (.*)!|.* (is|are) nearby (north|east|south|west|northeast|southeast|southwest|northwest|up|down) from here.|.* (is|are) not too far off (north|east|south|west|northeast|southeast|southwest|northwest|up|down) from here.|.* (is|are) fairly far (north|east|south|west|northeast|southeast|southwest|northwest|up|down) from here.|.* (is|are) a long ways off (north|east|south|west|northeast|southeast|southwest|northwest|up|down) from here.|(.*) gesticulates and suddenly (.*) is vomiting as [hisherits]* organs twist!|(.*)'s petrification spell turns (.*) to stone!|(.*) howls in agony as the magma clings to [hisherits]+ body!|(.*) unleashes a torrent of magma on (.*), charring [hisheritsyour]+ flesh severely!|(.*)'s blast of acid sprays (.*), sizzling and burning [hisheritsyour]+ skin!|(.*) dodges aside but is still affected (.*)'s acid blast.|(.*) throws a flurry of magic missile at (.*)!|You are blinded!|(.*) tosses [hisherits]+ glowing spear at (.*) and rejoices as it hits [himherit]+.|(.*)'s faithful spear sails wide, but (.*) still cringes in pain.|(.*) fires a lance of gloom at (.*) which envelopes [herhimityou]+ in shadow.|(.*) drains some of (.*)'s magical energy!|(.*) cringe[s]* in terror from (.*)'s bolt of glory!|(.*) surrounded by a nimbus of holy light!|(.*) bursts into a glorious flash of holy light and crumbles to dust!|(.*) weep[s]* in pain and despair as (.*)'s bolt of glory hits [himherityou]+.|(.*) causes bloody wounds to open in (.*)'s arms and legs!|(.*) causes large, bloody wounds to open in (.*)'s chest!|(.*) causes blood to trickle from (.*)'s eyes and ears!|(.*) appears to be deaf.|You are deafened!|(.*) look[s]* tired and weak.|(.*) shivers and looks very ill.|(.*) looks very ill.|You feel very sick.|You smell (.*)'s roasting flesh as (.*) burns [himherit]+ with hellfire!|(.*) dodge[s]* aside as (.*)'s hellfire washes over [himherityou]+.|(You) feel your flesh roast as (.*) burns you with [hisherits]+ hellfire!|(.*) whiten[s]* slightly as (.*) drains a portion of [itsherhisyour]+ life-force!|(.*) stagger[s]* momentarily after (.*) points [hisherits]+ finger at [himherityou]+!|(.*) begin[s]* to drool at the mouth.|(.*) turn[s]* blue and shivers.|(.*) shivers but fights on as (.*) attacks with [hisherits]+ chill touch!|(.*) gets a wild look in [hisherits]+ eyes.|(.*) enveloped in a mantle of deepest darkness.|(.*) whitens as (.*) drains a large portion of its life-force!|(.*) appears withered and pale after (.*) drains its blood.|(.*) screams in agony as plague sores erupt from its skin.|(.*) fills the room with a tangible aura of fear and horror!|You howl in agony as the magma clings to your body!|(.*) turns ethereal.|(.*) is knocked unconscious by the force of (.*)'s blow!|You are knocked unconscious by the force of (.*)'s blow!|(.*) cries out in pain as (.*) touches [himherit]+ with his electrical hands.|(.*) manages to slap (.*)'s hands away before .* can electrocute it!|(.*) goes into spasm as (.*)'s bolt of lightning slams into [himherit]+!|(.*) wavers under the impact of (.*)'s lightning bolt, its body twitching!|(.*) opens a gate to its own plane and steps through.|(.*) slows to normal speed!|(.*) is moving more slowly.|(.*)'s muscles lose their heightened power!|You feel yourself moving more slowly.|You feel stronger.|You feel yourself speed up.|(.*) is knocked senseless by the force of (.*)'s blow!|You rub the dirt out of your eyes.|(.*) seems to glow faintly, his eyes gleaming with newfound energy.)$"
   omit_from_output="y"
   regexp="y"
   script="replaceRedirect"
   sequence="5"
  >
  </trigger>
</triggers>

<aliases>
  <alias
   match="^tar(?:g|ge|get)? ([a-zA-Z0-9\-\s]+)$"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>
clientCheck = "%" .. "1"
if "%1" ~= clientCheck then
	if "%1" ~= "" then
		target = "%1"
		SetVariable("target", target)
		Note("Target: %1")
	else 
		target = ""
		SetVariable("target", target)
		Note("Target Cleared")
	end
else
	if matches[2] then
		target = matches[2]
		echo("Target: " .. matches[2])
		if targetID then killTrigger(targetID) end
		targetID = tempRegexTrigger("(?i)("..target..")", [[selectString(matches[2], 1) fg("red") resetFormat()]])
		--targetID = tempRegexTrigger("(?i)("..target..")", function() selectString(target, 1) fg("red") deselect() resetFormat() end)
	else 
		target = ""
		echo("Target Cleared")
		killTrigger(targetID)
	end
end
  
</send>
  </alias>
  <alias
   match="^tar$"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>
clientCheck = "%" .. "1"
if "%1" ~= clientCheck then
	Note("Current Target: " .. GetVariable("target"))
else
	echo("Current Target: " .. target)
end  
</send>
  </alias>
</aliases>

<script>
<![CDATA[
backgroundColor = "black"
highlightNormal = "silver"
highlightCombat = "green"
highlightColor1 = "cyan"
highlightColor2 = "#FF6347" -- tomato red
highlightColor3 = "#98ff98" -- mint green
highlightColor4 = "#EE82EE" -- violet
highlightColor5 = "magenta"
highlightColor6 = "brown"

tagStart = "~>~>~> "
tagEnd = "<~<~<~"

function stylize(fColor, bColor, stylizeText)
	return {
          text = stylizeText,
          textcolour  = fColor,
          backcolour = bColor,
          length = string.len (stylizeText),
          style = 0,
        }
end

function chatRedirect (styles)
  require "serialize"
  check(CallPlugin ("10778718503f0c91106745f5", "display", serialize.save_simple (styles)))
end

function echoEditor(highlightColor1, backgroundColor, line)
	ColourNote(highlightColor1, backgroundColor, line)
end

function customNotify(foreground, text) 
	styles = {}
	table.insert(styles, stylize(ColourNameToRGB(foreground), ColourNameToRGB("black"), text))
	chatRedirect(styles)
end

function notifyHighlight(command, person, personTarget)
	if personTarget and person then
		ColourTell(highlightColor1, backgroundColor, tagStart) 
		ColourTell(highlightColor3, backgroundColor, person .. " ") 
		ColourTell(highlightColor2, backgroundColor, command .. " ") 
		ColourTell(highlightColor4, backgroundColor, personTarget .. " ") 
		ColourTell(highlightColor1, backgroundColor, tagEnd) 
		Note("")
	elseif person then
		ColourTell(highlightColor1, backgroundColor, tagStart) 
		ColourTell(highlightColor3, backgroundColor, person .. " ") 
		ColourTell(highlightColor2, backgroundColor, command .. " ") 
		ColourTell(highlightColor1, backgroundColor, tagEnd)
		Note("")
	else
		ColourTell(highlightColor1, backgroundColor, tagStart) 
		ColourTell(highlightColor2, backgroundColor, command .. " ") 
		ColourTell(highlightColor1, backgroundColor, tagEnd) 
		Note("")
	end
	
	styles = {}
	if IsPluginInstalled("10778718503f0c91106745f5") then
		if personTarget and person then
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagStart))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor3), ColourNameToRGB(backgroundColor), person .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor2), ColourNameToRGB(backgroundColor), command .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor4), ColourNameToRGB(backgroundColor), personTarget .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagEnd))	
			chatRedirect(styles)
		elseif person then
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagStart))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor3), ColourNameToRGB(backgroundColor), person .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor2), ColourNameToRGB(backgroundColor), command .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagEnd))
			chatRedirect(styles)
		else
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagStart))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor2), ColourNameToRGB(backgroundColor), command .. " "))	
			table.insert(styles, stylize(ColourNameToRGB(highlightColor1), ColourNameToRGB(backgroundColor), tagEnd))
			chatRedirect(styles)
		end
	end
end


function highlightDirection(input, inputColor, inputBackground)
	target = GetVariable("target") or ""
	choppedInput = input
	if target ~= "" then
		l, m = string.find(string.lower(choppedInput), string.lower(target))
		if l and m and m ~= string.len(choppedInput) then
			_, matchCount = string.gsub(string.lower(choppedInput), string.lower(target), string.lower(target))
			for c = 1, matchCount do
				l, m = string.find(string.lower(choppedInput), string.lower(target))
				--Note(l)
				--Note(m)
				beforeTarget = string.sub(choppedInput, 0, l-1)
				matchTarget = string.sub(choppedInput, l, m)
				ColourTell(RGBColourToName (inputColor), RGBColourToName (inputBackground), beforeTarget) 
				ColourTell("red", RGBColourToName (inputBackground), matchTarget)
				--Note("chunk")
				choppedInput = string.sub(choppedInput, m+1)
			end
		end
	end
	
	i, j = nil
	if string.find(choppedInput, "northeast") then
		i, j = string.find(choppedInput, "northeast")
    elseif string.find(choppedInput, "southeast") then
		i, j = string.find(choppedInput, "southeast")
    elseif string.find(choppedInput, "southwest") then
		i, j = string.find(choppedInput, "southwest")
	elseif string.find(choppedInput, "northwest") then
		i, j = string.find(choppedInput, "northwest")
	elseif string.find(choppedInput, "north") then
		i, j = string.find(choppedInput, "north")
	elseif string.find(choppedInput, "south") then
		i, j = string.find(choppedInput, "south")
	elseif string.find(choppedInput, "east") then 
		i, j = string.find(choppedInput, "east")
	elseif string.find(choppedInput, "west") then 
		i, j = string.find(choppedInput, "west")
	elseif string.find(choppedInput, "up") then
		i, j = string.find(choppedInput, "up")
	elseif string.find(choppedInput, "down") then
		i, j = string.find(choppedInput, "down")
	end
	distance = "0"
	if string.find(choppedInput, "nearby") then
		distance = "1"
	elseif string.find(choppedInput, "not too far off") then
		distance = "2"
	elseif string.find(choppedInput, "fairly far") then
		distance = "3"
	elseif string.find(choppedInput, "a long ways off") then
		distance = "4"
	end

	if i and j then
		beforeText = string.sub(choppedInput, 0, i-1)
		highlightedText = string.sub(choppedInput, i, j)
		afterText = string.sub(choppedInput, j+1)
		ColourTell(RGBColourToName (inputColor), RGBColourToName (inputBackground), beforeText) 
		ColourTell(highlightColor1, RGBColourToName (inputBackground), highlightedText .. " " .. distance)
		ColourTell(RGBColourToName (inputColor), RGBColourToName (inputBackground), afterText)
		Note("")
	else
		ColourTell(RGBColourToName(inputColor), RGBColourToName (inputBackground), choppedInput)
	end

end

incantations = {
["aque bragh"] = "acid blast",
["aiuwahz oculoae"] = "animate dead",
["abrazak"] = "armor",
["babbrz"] = "babble",
["barh ay ohifl"] = "bolt of glory",
["fido"] = "bless",
["noselacri"] = "blindness",
["bcandusahp ay ruyz"] = "breath of life",
["mosailla paieg"] = "burning hands",
["qarr abrazak"] = "call armor",
["qarr diesilla"] = "call lightning",
["qaiqzrrann"] = "cancellation",
["qkadagz qfuhuqar"] = "cause critical",
["qkadagz dies"] = "cause light",
["qkadagz gzfuajg"] = "cause serious",
["qpaui diesilla"] = "chain lightning",
["qpaiozghayy"] = "changestaff",
["qpaioz gzn"] = "change sex",
["qpabraw dudasabru"] = "charm person",
["qpurr hajqp"] = "chill touch",
["qahif gsgrul"] = "color spray",
["qaiz ay qare"] = "cone of cold",
["qaiyjguai"] = "confusion",
["qaiyjcandus zrzwunsohar"] = "conjure elemental",
["qaigzqgruhz abrazak"] = "consecrate armor",
["qaigzqgruhz uhzw"] = "consecrate item",
["qaigzqgruhz xzasai"] = "consecrate weapon",
["qaihuijar dies"] = "continual light",
["qaihfar jioculoae"] = "control undead",
["qaihfar xzahpzf"] = "control weather",
["qcandusahz yaae"] = "create food",
["qcandusahz gsfuio"] = "create spring",
["qcandusahz xahzf"] = "create water",
["qcanduszsuio eaaw"] = "creeping doom",
["judicandus noselacri"] = "cure blindness",
["judicandus qfuhuqar"] = "cure critical",
["judicandus oculoaylacri"] = "cure deafness",
["judicandus eugzagz"] = "cure disease",
["judicandus dies"] = "cure light",
["judicandus sausabru"] = "cure poison",
["judicandus gzfuajg"] = "cure serious",
["judifgz"] = "curse",
["oculoaylacri"] = "deafness",
["oculoahp gpfaje"] = "death shroud",
["oculoszculayuqann"] = "depetrification",
["oculoinfra kadagru"] = "detect aura",
["oculoinfra mosauze"] = "detect buried",
["oculoinfra pueoculoi"] = "detect hidden",
["oculoinfra uizug"] = "detect invis",
["oculoinfra waouq"] = "detect magic",
["oculoinfra sausabru"] = "detect poison",
["oculozann"] = "devotion",
["euo"] = "dig",
["eugszr waouq"] = "dispel",
["eugsufuh"] = "dispirit",
["zabrahpdjatz"] = "earthquake",
["zrzwunsohar xarr"] = "elemental wall",
["unsoqpaih abrazak"] = "enchant armor",
["unsoqpaih uhzw"] = "enchant item",
["unsoqpaih xzasai"] = "enchant weapon",
["unsozfoukzf"] = "energizer",
["unsozfol egruui"] = "energy drain",
["unsorabraoz"] = "enlarge",
["unsohaiorz"] = "entangle",
["zhpzcandusaryafw"] = "etherealform",
["znafqugw"] = "exorcism",
["yazfuz yucandus"] = "faerie fire",
["yazfuz yao"] = "faerie fog",
["yzabra"] = "fear",
["yzagh ay yzabra"] = "feast of fear",
["yzzbrzwuie"] = "feeblemind",
["yuiar gculatz"] = "final strike",
["yuiozf ay oculoahp"] = "finger of death",
["yucandusbarr"] = "fireball",
["yrawzgculatz"] = "flamestrike",
["yrl"] = "fly",
["ycandusikl"] = "frenzy",
["oahz"] = "gate",
["ouaih ghcandusiohp"] = "giant strength",
["ohiaw raiqz"] = "gloom lance",
["ocandusunso hpjwb"] = "green thumb",
["pawwzf ay dies"] = "hammer of light",
["pabraw"] = "harm",
["paghz"] = "haste",
["pzar"] = "heal",
["pzaruio grulg"] = "healing rays",
["pzrryucandus"] = "hellfire",
["pzzakfpaoz"] = "hemorrhage",
["parl glwbar"] = "holy symbol",
["parl xafe"] = "holy word",
["uoculoihuyl"] = "identify",
["uiygruzuguai"] = "infravision",
["uihzfeuqnn"] = "interdiction",
["uizuiqubrz kadagru"] = "invincible aura",
["uizug"] = "invis",
["ufaiojabrae"] = "ironguard",
["diesunso hiae"] = "lighten load",
["diesilla barh"] = "lightning bolt",
["hiqahz abyzqh"] = "locate object",
["waouq wuggurz"] = "magic missile",
["waouqar zzghwunsoh"] = "magical vestment",
["waowa gsgrul"] = "magma spray",
["wagg pzaruio"] = "mass healing",
["wagg uizug"] = "mass invis",
["wueiuoph"] = "midnight",
["wuwuq"] = "mimic",
["wuffaf uwaoz"] = "mirror image",
["szculayuqann"] = "petrification",
["spaunsoun pzabrah"] = "phoenix heart",
["sraojz"] = "plague",
["sausabru"] = "poison",
["sarlzaksp"] = "polymorph",
["sfainfrauai"] = "protection",
["gruugz oculoae"] = "raise dead",
["candusqpabraoz"] = "recharge",
["candusima"] = "refresh",
["candusounsozgrunn"] = "regeneration",
["candussido qawsjrguai"] = "remove compulsion",
["candussido judifgz"] = "remove curse",
["candusgugh zrzwunsohg"] = "resist elements",
["candusgjfcandusqnn"] = "resurrection",
["fuyh"] = "rift",
["gaiqhjabral"] = "sanctuary",
["gpuzre"] = "shield",
["gpaqtuio ogrugs"] = "shocking grasp",
["gpfuit"] = "shrink",
["grzzs"] = "sleep",
["ghix"] = "slow",
["gszabra ay yauhp"] = "spear of faith",
["gszrr xabrae"] = "spell ward",
["gsufuh kadagru"] = "spirit aura",
["gsufuh earr"] = "spirit doll",
["gsufuh pafoculo"] = "spirit horde",
["gsufuh guoph"] = "spirit sight",
["ghaiz gtui"] = "stone skin",
["gjwwai"] = "summon",
["glwbar ay saui"] = "symbol of pain",
["hzrzsafh"] = "teleport",
["hunsozbfuajg mosagh"] = "tenebrious burst",
["haiojzg"] = "tongues",
["hgruqtrzgg ghzs"] = "trackless step",
["jwbgru waihrz"] = "umbra mantle",
["jioculofghaie"] = "understand",
["zawsufuq hajqp"] = "vampiric touch",
["zuharuhl"] = "vitality",
["zaaeaa"] = "voodoo",
["xabras gsaqz"] = "warp space",
["xabrasahp"] = "warpath",
["xzatunso"] = "weaken",
["xafe ay candusqarr"] = "word of recall",
["eawuiann"] = "domination",
["gzaiqz"] = "seance",
["aqqzrzgruhz pzaruio"] = "accelerate healing",
["zwdudaafg yazaf"] = "emperor's favor",
["gqahhzfsafh"] = "scatterport",
["UNKNOWN"] = "distort alignment",
["UNKNOWN"] = "insight",
["UNKNOWN"] = "luck",
["UNKNOWN"] = "true sight"
}

notifications = {
["qarr diesilla"] = "call lightning",
["oculoinfra kadagru"] = "detect aura",
["yrawzgculatz"] = "flamestrike",
["parl xafe"] = "holy word",
["qpabraw dudasabru"] = "charm person",
["qahif gsgrul"] = "color spray",
["grzzs"] = "sleep",
["eugszr waouq"] = "dispel",
["qaiz ay qare"] = "cone of cold",
["qpaui diesilla"] = "chain lightning",
["zabrahpdjatz"] = "earthquake",
["yucandusbarr"] = "fireball",
["mosailla paieg"] = "burning hands",
["qcanduszsuio eaaw"] = "creeping doom",
["pzaruio grulg"] = "healing rays",
["gsufuh pafoculo"] = "spirit horde",
["yuiar gculatz"] = "final strike"
}

notificationsReverse = {}

for i, v in pairs(notifications) do
	notificationsReverse[v] = i
end



function replaceRedirect (name, line, wildcards, styles)
	line = string.gsub(line, "> ", "")
	if line == "Your pulse slows to normal." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "You regain your footing." then
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("YOU GOT BACK UP")
	elseif line == "There is too much chaos going on right now." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "Your spirit feels more settled." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "Your body feels less fatigued." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "Your skin feels soft again." then
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("STONE SKIN DOWN")
	elseif line == "You feel level-headed again." then
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("TAUNT/HECKLE WORE OFF")
	elseif line == "The ether wire phases partially out of existence. " then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "You fight a battle of inner will." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif string.find(line, "^(.*) sounds the retreat!$") then
		person = string.match(line, "^(.*) sounds the retreat!$")
		echoEditor(highlightColor6, backgroundColor, line)
		notifyHighlight("RETREATS", person)
	elseif line == "You thunder forth a tremendous rallying cry!" then
		echoEditor(highlightColor6, backgroundColor, line)
		notifyHighlight("RALLYING CRY SUCCESSFUL")
	elseif string.find(line, "^(.*) thunders forth a tremendous rallying cry!$") then
		person = string.match(line, "^(.*) thunders forth a tremendous rallying cry!$")
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("RALLYING CRY", person)
	elseif line == "You retain your stance." then
		echoEditor(highlightColor1, backgroundColor, line)
	elseif line == "You need to regain your feet first." then
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("STILL PRONE")
	elseif line == "You regain consciousness and rise unsteadily to your feet." then
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("YOU RECOVERED FROM STUN")
	elseif line == "Your spirit companions leave you." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPIRIT AURA DOWN")
	elseif line == "You feel less protected." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ARMOR/PROT/RESIST ELEMENTS DOWN")
	elseif line == "Your clothing feels soft again." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("MAGICAL VESTMENT DOWN")
	elseif line == "You feel less righteous." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BLESS DOWN")
	elseif line == "Your ward dissolves." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IRONGUARD DOWN")
	elseif line == "Your skin feels soft again." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("STONE SKIN DOWN")
	elseif line == "Your rage ebbs." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FRENZY DOWN")
	elseif line == "You slowly float to the ground." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FLY DOWN")
	elseif line == "The bubble of airy water collapses." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("AIRY WATER DOWN")
	elseif line == "You are no longer invisible." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("INVIS DOWN")
	elseif line == "Your force shield shimmers then fades away." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SHIELD DOWN")
	elseif line == "Your spell ward dissolves." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPELL WARD DOWN")
	elseif line == "You feel yourself slow down." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HASTE DOWN")
	elseif line == "You feel weaker." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("GIANT STRENGTH DOWN/WEAKEN")
	elseif line == "The white aura around your body fades." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SANCTUARY DOWN")
	elseif line == "You are ready to summon another treant." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CHANGESTAFF")
	elseif line == "You feel able to conjure another elemental." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ELEMENTAL READY")
	elseif line == "You feel your pulse slow down." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("RALLYING CRY DOWN")
	elseif line == "Yippee! It worked." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BABBLE")
	elseif line == "Better stand up first." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("STAND UP")
	elseif line == "Your elemental flickers slightly." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ELEMENTAL ONE TICK")
	elseif line == "That group is in the thick of battle." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CANNOT STAB")
	elseif line == "Your mount is now rested and recharged." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPIRIT STEED READY")
	elseif line == "You no longer see in the dark." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("INFRAVISION DOWN")
	elseif line == "A spirit steed glows brightly and vanishes back to the upper planes." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPIRIT STEED DOWN")
	elseif line == "Your spirit companion flickers slightly." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPIRIT STEED ONE TICK")
	elseif line == "Your bash misses and you fall flat on your face!" then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE PRONE (Missed Bash)")
	elseif line == "You feel unclean." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE CURSED")
	elseif line == "You are too busy defending yourself." then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CANNOT CIRCLE")
	elseif string.find(line, "^(.*) regains consciousness and rises unsteadily to [itshisher]* feet.$") then
		person = string.match(line, "^(.*) regains consciousness and rises unsteadily to [itshisher]* feet.$")
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("RECOVERED FROM STUN", person)
	elseif string.find(line, "^(.*) starts to concentrate.$") then
		echoEditor(highlightColor2, backgroundColor, line)
	elseif string.find(line, "^(.*) utters the words, (.*).$") then
		person = string.match(line, "([a-zA-Z%s\-\']*) utters the words")
		incantation = string.match(line, "'([a-zA-Z%s]*)'")
		ColourTell(highlightColor1, backgroundColor, person)
		ColourTell(highlightColor5, backgroundColor, " utters the words, '")
		ColourTell(highlightColor1, backgroundColor, incantations[incantation] or incantation)
		ColourTell(highlightColor5, backgroundColor, "'.")
		Note("")
		if notifications[incantation] then
			notifyHighlight("CASTED" .. " " .. incantations[incantation], person)
		elseif notificationsReverse[incantation] then
			notifyHighlight("CASTED" .. " " .. incantation, person)
		end
	elseif string.find(line, "^(.*) glows with mystical energy!") then
		echoEditor(highlightColor2, backgroundColor, line)
	elseif string.find(line, "^(.*) regains [hisherits]* footing.$") then
		person = string.match(line, "^(.*) regains [hisherits]* footing.$")
		echoEditor(highlightColor1, backgroundColor, line)
		notifyHighlight("GOT BACK UP", person)
	elseif string.find(line, "^You assume [an]* [neutraldefensiveaggressive]* stance.$") then
		echoEditor(highlightColor6, backgroundColor, line)
	elseif string.find(line, "^You trip (.*) and [hesheit]* goes down!$") then
		person = string.match(line, "You trip (.*) and [hesheit]* goes down!$")
		echoEditor(highlightCombat, backgroundColor, line)
		notifyHighlight("IS PRONE (Tripped)", person)
	elseif string.find(line, "^You start to [praychant]*.$") then
		echoEditor(highlightNormal, backgroundColor, "You start to concentrate.")
	elseif string.find(line, "^(.*) starts to [praychant]*.$") then
		echoEditor(highlightColor2, backgroundColor, string.match(line, "^(.*) starts to [praychant]*.$") .. " starts to concentrate.")
	elseif string.find(line, "^Pink flames surround (.*).$") then
		person = string.match(line, "^Pink flames surround (.*).$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FAERIE FIRED", person)
	elseif string.find(line, "^(.*) looks very uncomfortable.$") then
		person = string.match(line, "^(.*) looks very uncomfortable.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CURSED", person)
	elseif string.find(line, "^You fail to disarm (.*).$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FAILED DISARM")
	elseif string.find(line, "^(.*) weapon won't budge!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CURSED WEAPON")
	elseif string.find(line, "^(.*) is still hyper%-alert from combat.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HYPER ALERT")
	elseif string.find(line, "^Your sly taunts cause (.*) to charge you in fury.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("TAUNT SUCCEEDED")
	elseif string.find(line, "^(.*) tries to taunt you. Maybe you should teach [himherit]* a lesson%?$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE TAUNTED")
	elseif string.find(line, "^(.*) goes crazy as (.*) begins taunting [himherit]* mercilessly.$") then
		person = string.match(line, "^.* goes crazy as (.*) begins taunting [himherit]* mercilessly.$")
		personTarget = string.match(line, "^(.*) goes crazy as .* begins taunting [himherit]* mercilessly.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("TAUNTED", person, personTarget)
	elseif string.find(line, "^(.*) attempts to taunt (.*), but just sounds lame.$") then
		person = string.match(line, "^(.*) attempts to taunt .*, but just sounds lame.$")
		personTarget = string.match(line, "^.* attempts to taunt (.*), but just sounds lame.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FAILED TAUNT", person, personTarget)
	elseif string.find(line, "^(.*) sly taunts cause (.*) to charge [himherit]* in fury.$") then
		person = string.match(line, "^(.*) sly taunts cause .* to charge [himherit]* in fury.$")
		personTarget = string.match(line, "^.* sly taunts cause (.*) to charge [himherit]* in fury.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("TAUNTED", person, personTarget)
	elseif string.find(line, "^(.*) is blinded by the dirt in [hisherits]* eyes!$") then
		person = string.match(line, "^(.*) is blinded by the dirt in .* eyes!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BLINDED BY DIRT", person)
	elseif string.find(line, "^(.*) appears to be blinded.$") then
		person = string.match(line, "^(.*) appears to be blinded.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BLINDED BY SPELL", person)
	elseif string.find(line, "^(.*) trips you and you go down!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE PRONE (TRIPPED)")
	elseif string.find(line, "^(.*) tries to trip (.*) but ends up tripping [himselfherselfitself]*!$") then
		person = string.match(line, "^(.*) tries to trip .* but ends up tripping [himselfherselfitself]*!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS PRONE (Missed Trip)", person)
	elseif string.find(line, "^You try to trip (.*) but end up tripping yourself!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE PRONE (Missed Trip)")
	elseif string.find(line, "^(.*)'s bash misses and [hesheit]* falls flat on [hisherits]* face.$") then
		person = string.match(line, "^(.*)'s bash misses and [hesheit]* falls flat on [hisherits]* face.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS PRONE (Missed Bash)", person)
	elseif string.find(line, "^You evade (.*)'s bash and [hesheit]* falls flat on [hisherits]* face.$") then
		person = string.match(line, "^You evade (.*)'s bash and [hesheit]* falls flat on [hisherits]* face.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS PRONE (Missed Bash)", person)
	elseif string.find(line, "^You slam into (.*) and send [himherit]* sprawling!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BASH SUCCEEDED")
	elseif string.find(line, "^Your methodical attack breaks down as (.*) taunts you.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE TAUNTED")
	elseif string.find(line, "^Both of [itshisher]* legs are already mangled.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SWITCH TO CIRCLE")
	elseif string.find(line, "^(.*) disarms you but you secure your weapon.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE DISARMED.  WIELD WEAPON")
	elseif string.find(line, "^You disarm (.*) and send [hisherits]+ weapon flying!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DISARM SUCCEEDED")
	elseif string.find(line, "^(.*) slams into (.*) and sends .* sprawling!$") then
		person = string.match(line, "^(.*) slams into .* and sends .* sprawling!$")
		personTarget = string.match(line, "^.* slams into (.*) and sends .* sprawling!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BASHED", person, personTarget)
	elseif string.find(line, "^(.*) trips (.*) sending [himherit]* to the ground.$") then
		person = string.match(line, "^(.*) trips .* sending [himherit]* to the ground.$")
		personTarget = string.match(line, "^.* trips (.*) sending [himherit]* to the ground.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("TRIPPED", person, personTarget)
	elseif string.find(line, "^(.*) disarms you and sends your weapon flying!$") then
		echoEditor(highlightColor6, backgroundColor, line)
		notifyHighlight("YOU ARE DISARMED")
	elseif string.find(line, "^(.*) disarms (.*) and sends [hisherits]+ weapon flying!$") then
		person = string.match(line, "^(.*) disarms .* and sends [hisherits]+ weapon flying!$")
		personTarget = string.match(line, "^.* disarms (.*) and sends [hisherits]+ weapon flying!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DISARMED", person, personTarget)
	elseif string.find(line, "^(.*) disarms (.*)!$") then
		person = string.match(line, "^(.*) disarms .*!$")
		personTarget = string.match(line, "^.* disarms (.*)!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DISARMED", person, personTarget)
	elseif string.find(line, "^(.*) is standing behind your victim, blocking your attack.$") then
		person = string.match(line, "^(.*) is standing behind your victim, blocking your attack.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS IN THE WAY. BLOCKING!", person)
	elseif string.find(line, "^You disarm (.*)!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DISARM SUCCEEDED")
	elseif string.find(line, "^(.*) tries to disarm you, but fails.$") then
		person = string.match(line, "^(.*) tries to disarm you, but fails.$")
		echoEditor(highlightCombat, backgroundColor, line)
		notifyHighlight("DISARM ATTEMPT WARNING", person)
	elseif string.find(line, "^.* [isare]* nearby [northeast|southwestnortheastsoutheastsouthwestnorthwestupdown]* from here.$") or string.find(line, "^.* [isare]* not too far off [northeastsouthwestnortheastsoutheastsouthwestnorthwestupdown]* from here.$") or string.find(line, "^.* [isare]* fairly far [northeastsouthwestnortheastsoutheastsouthwestnorthwestupdown]* from here.$") or string.find(line, "^.* [isare]* a long ways off [northeastsouthwestnortheastsoutheastsouthwestnorthwestupdown]* from here.$") then
		for _, v in ipairs (styles) do
			highlightDirection(v.text, v.textcolour, v.backcolour)
		end
	elseif string.find(line, "^(.*) gesticulates and suddenly (.*) is vomiting as [hisherits]* organs twist!$") then
		person = string.match(line, "^(.*) gesticulates and suddenly .* is vomiting as [hisherits]* organs twist!$")
		personTarget = string.match(line, "^.* gesticulates and suddenly (.*) is vomiting as [hisherits]* organs twist!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HARMED", person, personTarget)
	elseif string.find(line, "^(.*)\'s petrification spell turns (.*) to stone!$") then
		person = string.match(line, "^(.*)\'s petrification spell turns .* to stone!$")
		personTarget = string.match(line, "^.*\'s petrification spell turns (.*) to stone!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("PETRIFIED", person, personTarget)
	elseif string.find(line, "^(.*) howls in agony as the magma clings to [hisherits]+ body!$") then
		person = string.match(line, "^(.*) howls in agony as the magma clings to [hisherits]+ body!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("MAGMA CLUNG ON", person)
	elseif string.find(line, "^(.*) unleashes a torrent of magma on (.*), charring [hisheritsyour]+ flesh severely!$") then
		person = string.match(line, "^(.*) unleashes a torrent of magma on .*, charring [hisheritsyour]+ flesh severely!$")
		personTarget = string.match(line, "^.* unleashes a torrent of magma on (.*), charring [hisheritsyour]+ flesh severely!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("MAGMAS", person, personTarget)
	elseif string.find(line, "^(.*)'s blast of acid sprays (.*), sizzling and burning [hisheritsyour]+ skin!$") then
		person = string.match(line, "^(.*)'s blast of acid sprays .*, sizzling and burning [hisheritsyour]+ skin!$")
		personTarget = string.match(line, "^.*'s blast of acid sprays (.*), sizzling and burning [hisheritsyour]+ skin!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ACID BLASTS", person, personTarget)
	elseif string.find(line, "^(.*) dodges aside but is still affected (.*)'s acid blast.$") then
		person = string.match(line, "^.* dodges aside but is still affected (.*)'s acid blast.$")
		personTarget = string.match(line, "^(.*) dodges aside but is still affected .*'s acid blast.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ACID BLASTS", person, personTarget)
	elseif string.find(line, "^(.*) throws a flurry of magic missile at (.*)!$") then
		person = string.match(line, "^(.*) throws a flurry of magic missile at .*!$")
		personTarget = string.match(line, "^.* throws a flurry of magic missile at (.*)!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("MAGIC MISSILES", person, personTarget)
	elseif string.find(line, "^(.*) tosses [hisherits]+ glowing spear at (.*) and rejoices as it hits [himherit]+.$") then
		person = string.match(line, "^(.*) tosses [hisherits]+ glowing spear at .* and rejoices as it hits [himherit]+.$")
		personTarget = string.match(line, "^.* tosses [hisherits]+ glowing spear at (.*) and rejoices as it hits [himherit]+.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPEAR OF FAITHS", person, personTarget)
	elseif string.find(line, "^(.*)'s faithful spear sails wide, but (.*) still cringes in pain.$") then
		person = string.match(line, "^(.*)'s faithful spear sails wide, but .* still cringes in pain.$")
		personTarget = string.match(line, "^.*'s faithful spear sails wide, but (.*) still cringes in pain.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SPEAR OF FAITHS", person, personTarget)
	elseif string.find(line, "^(.*) fires a lance of gloom at (.*) which envelopes [herhimityou]+ in shadow.$") then
		person = string.match(line, "^(.*) fires a lance of gloom at .* which envelopes [herhimityou]+ in shadow.$")
		personTarget = string.match(line, "^.* fires a lance of gloom at (.*) which envelopes [herhimityou]+ in shadow.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("GLOOM LANCES", person, personTarget)
	elseif string.find(line, "^(.*) drains some of (.*)'s magical energy!$") then
		person = string.match(line, "^(.*) drains some of .*'s magical energy!$")
		personTarget = string.match(line, "^.* drains some of (.*)'s magical energy!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("MANA DRAINS", person, personTarget)
	elseif string.find(line, "^You are blinded!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE BLINDED")
	elseif string.find(line, "^(.*) cringe[s]* in terror from (.*)'s bolt of glory!$") then
		person = string.match(line, "^.* cringe[s]* in terror from (.*)'s bolt of glory!$")
		personTarget = string.match(line, "^(.*) cringe[s]* in terror from .*'s bolt of glory!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BoGs", person, personTarget)
	elseif string.find(line, "^(.*) surrounded by a nimbus of holy light!$") then
		person = string.match(line, "^(.*) surrounded by a nimbus of holy light!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("TAUNTED BY BoG", person)
	elseif string.find(line, "^(.*) bursts into a glorious flash of holy light and crumbles to dust!$") then
		person = string.match(line, "^(.*) bursts into a glorious flash of holy light and crumbles to dust!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("INSTANTLY DIES BY BoG", person)
	elseif string.find(line, "^.* weep[s]* in pain and despair as (.*)'s bolt of glory hits [himherityou]+.$") then
		person = string.match(line, "^.* weep[s]* in pain and despair as (.*)'s bolt of glory hits [himherityou]+.$")
		personTarget = string.match(line, "^(.*) weep[s]* in pain and despair as .*'s bolt of glory hits [himherityou]+.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BoGs", person, personTarget)
	elseif string.find(line, "^(.*) causes bloody wounds to open in (.*)'s arms and legs!$") then
		person = string.match(line, "^(.*) causes bloody wounds to open in .*'s arms and legs!$")
		personTarget = string.match(line, "^.* causes bloody wounds to open in (.*)'s arms and legs!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CAUSE LIGHTS", person, personTarget)
	elseif string.find(line, "^(.*) causes large, bloody wounds to open in .*'s chest!$") then
		person = string.match(line, "^(.*) causes large, bloody wounds to open in .*'s chest!$")
		personTarget = string.match(line, "^.* causes large, bloody wounds to open in (.*)'s chest!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CAUSE SERIOUS", person, personTarget)
	elseif string.find(line, "^(.*) causes blood to trickle from (.*)'s eyes and ears!$") then
		person = string.match(line, "^(.*) causes blood to trickle from .*'s eyes and ears!$")
		personTarget = string.match(line, "^.* causes blood to trickle from (.*)'s eyes and ears!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CAUSE CRITICALS", person, personTarget)
	elseif string.find(line, "^(.*) appears to be deaf.$") then
		person = string.match(line, "^(.*) appears to be deaf.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS DEAFENED", person)
	elseif string.find(line, "^You are deafened!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE DEAFENED")
	elseif string.find(line, "^(.*) look[s]* tired and weak.$") then
		person = string.match(line, "^(.*) look[s]* tired and weak.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("WEAKENED", person)
	elseif string.find(line, "^(.*) shivers and looks very ill.$") then
		person = string.match(line, "^(.*) looks very ill.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS POISONED", person)
	elseif string.find(line, "^(.*) looks very ill.$") then
		person = string.match(line, "^(.*) looks very ill.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS POISONED", person)
	elseif string.find(line, "^You feel very sick.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE POISON")
	elseif string.find(line, "^You smell (.*)'s roasting flesh as (.*) burns [himherit]+ with hellfire!$") then
		person = string.match(line, "^You smell .*'s roasting flesh as (.*) burns [himherit]+ with hellfire!$")
		personTarget = string.match(line, "^You smell (.*)'s roasting flesh as .* burns [himherit]+ with hellfire!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HELLFIRES", person, personTarget)
	elseif string.find(line, "^(.*) dodge[s]* aside as (.*)'s hellfire washes over [himherityou]+.$") then
		person = string.match(line, "^.* dodge[s]* aside as (.*)'s hellfire washes over [himherityou]+.$")
		personTarget = string.match(line, "^(.*) dodge[s]* aside as .*'s hellfire washes over [himherityou]+.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HELLFIRES", person, personTarget)
	elseif string.find(line, "^(You) feel your flesh roast as (.*) burns you with [hisherits]+ hellfire!$") then
		person = string.match(line, "^You feel your flesh roast as (.*) burns you with his hellfire!$")
		personTarget = string.match(line, "^(You) feel your flesh roast as .* burns you with his hellfire!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("HELLFIRES", person, personTarget)
	elseif string.find(line, "^(.*) stagger[s]* momentarily after (.*) points [hisherits]+ finger at [himherityou]+!$") then
		person = string.match(line, "^.* stagger[s]* momentarily after (.*) points [hisherits]+ finger at [himherityou]+!$")
		personTarget = string.match(line, "^(.*) stagger[s]* momentarily after .* points [hisherits]+ finger at [himherityou]+!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FoDs", person, personTarget)
	elseif string.find(line, "^(.*) begin[s]* to drool at the mouth.$") then
		person = string.match(line, "^(.*) begin[s]* to drool at the mouth.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("FEEBLEMINDED", person)
	elseif string.find(line, "^(.*) turn[s]* blue and shivers.$") then
		person = string.match(line, "^(.*) turn[s]* blue and shivers.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS CHILL TOUCH WEAKENED", person)
	elseif string.find(line, "^(.*) shivers but fights on as (.*) attacks with [hisherits]+ chill touch!$") then
		person = string.match(line, "^.* shivers but fights on as (.*) attacks with [hisherits]+ chill touch!$")
		personTarget = string.match(line, "^(.*) shivers but fights on as .* attacks with [hisherits]+ chill touch!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CHILL TOUCHES", person, personTarget)
	elseif string.find(line, "^(.*) gets a wild look in [herhisits]+ eyes.$") then
		person = string.match(line, "^(.*) gets a wild look in [herhisits]+ eyes.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("BERSERKED/FRENZIED/FURIED", person)
	elseif string.find(line, "^(.*) whiten[s]* slightly as (.*) drains a portion of [itsherhisyour]+ life%-force!$") then
		person = string.match(line, "^.* whiten[s]* slightly as (.*) drains a portion of [itsherhisyour]+ life%-force!$")
		personTarget = string.match(line, "^(.*) whiten[s]* slightly as .* drains a portion of [itsherhisyour]+ life%-force!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ENERGY DRAINS", person, personTarget)
	elseif string.find(line, "^(.*) enveloped in a mantle of deepest darkness.$") then
		person = string.match(line, "^(.*) enveloped in a mantle of deepest darkness.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("UMBRA MANTLED", person, personTarget)
	elseif string.find(line, "^(.*) whitens as (.*) drains a large portion of its life%-force!$") then
		person = string.match(line, "^.* whitens as (.*) drains a large portion of its life%-force!$")
		personTarget = string.match(line, "^(.*) whitens as .* drains a large portion of its life%-force!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("ENERGY DRAINS", person, personTarget)
	elseif string.find(line, "^(.*) appears withered and pale after (.*) drains its blood.$") then
		person = string.match(line, "^.* appears withered and pale after (.*) drains its blood.$")
		personTarget = string.match(line, "^(.*) appears withered and pale after .* drains its blood.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("VAMPIRIC TOUCHED", person, personTarget)
	elseif string.find(line, "^(.*) screams in agony as plague sores erupt from its skin.$") then
		person = string.match(line, "^(.*) screams in agony as plague sores erupt from its skin.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS PLAGUED", person)
	elseif string.find(line, "^(.*) fills the room with a tangible aura of fear and horror!$") then
		person = string.match(line, "^(.*) fills the room with a tangible aura of fear and horror!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("CASTED fear", person)
	elseif string.find(line, "^You howl in agony as the magma clings to your body!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU HAVE MAGMA ON YOU")
	elseif string.find(line, "^(.*) turns ethereal.$") then
		person = string.match(line, "^(.*) turns ethereal.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS ETHEREAL", person)
	elseif string.find(line, "^(.*) is knocked unconscious by the force of (.*)'s blow!$") then
		person = string.match(line, "^.* is knocked unconscious by the force of (.*)'s blow!$")
		personTarget = string.match(line, "^(.*) is knocked unconscious by the force of .*'s blow!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("KNOCKS OUT (Headbutt)", person, personTarget)
	elseif string.find(line, "^You are knocked unconscious by the force of (.*)'s blow!$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU ARE KNOCKED OUT (Headbutt)")
	elseif string.find(line, "^(.*) cries out in pain as (.*) touches [himherit]+ with his electrical hands.$") then
		person = string.match(line, "^.* cries out in pain as (.*) touches [himherit]+ with his electrical hands.$")
		personTarget = string.match(line, "^(.*) cries out in pain as .* touches [himherit]+ with his electrical hands.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SHOCKING GRASPS", person, personTarget)
	elseif string.find(line, "^(.*) manages to slap (.*)'s hands away before .* can electrocute it!$") then
		person = string.match(line, "^.* manages to slap (.*)'s hands away before .* can electrocute it!$")
		personTarget = string.match(line, "^(.*) manages to slap .*'s hands away before .* can electrocute it!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SHOCKING GRASPS", person, personTarget)
	elseif string.find(line, "^(.*) wavers under the impact of (.*)'s lightning bolt, its body twitching!$") then
		person = string.match(line, "^.* wavers under the impact of (.*)'s lightning bolt, its body twitching!$")
		personTarget = string.match(line, "^(.*) wavers under the impact of .*'s lightning bolt, its body twitching!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("LIGHTNING BOLTS", person, personTarget)
	elseif string.find(line, "^(.*) goes into spasm as (.*)'s bolt of lightning slams into [himherit]+!$") then
		person = string.match(line, "^.* goes into spasm as (.*)'s bolt of lightning slams into [himherit]+!$")
		personTarget = string.match(line, "^(.*) goes into spasm as .*'s bolt of lightning slams into [himherit]+!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("LIGHTNING BOLTS", person, personTarget)
	elseif string.find(line, "^(.*) opens a gate to its own plane and steps through.$") then
		person = string.match(line, "^(.*) opens a gate to its own plane and steps through.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DISAPPEARS", person)
	elseif string.find(line, "^(.*) slows to normal speed!$") then
		person = string.match(line, "^(.*) slows to normal speed!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("LOST HASTE", person)
	elseif string.find(line, "^(.*) is moving more slowly.$") then
		person = string.match(line, "^(.*) is moving more slowly.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("IS SLOWED", person)
	elseif string.find(line, "^(.*)'s muscles lose their heightened power!$") then
		person = string.match(line, "^(.*)'s muscles lose their heightened power!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("LOST GIANT STRENGTH", person)
	elseif string.find(line, "^You feel yourself moving more slowly.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("YOU LOST HASTE")
	elseif string.find(line, "^You feel stronger.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("WEAKEN WORE OFF")
	elseif string.find(line, "^You feel yourself speed up.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("SLOW WORE OFF")
	elseif string.find(line, "^(.*) is knocked senseless by the force of (.*)'s blow!$") then
		person = string.match(line, "^.* is knocked senseless by the force of (.*)'s blow!$")
		personTarget = string.match(line, "^(.*) is knocked senseless by the force of .*'s blow!$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("KNOCKS OUT (Headbutt)", person, personTarget)	
	elseif string.find(line, "^You rub the dirt out of your eyes.$") then
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("DIRT KICK WORE OFF")
	elseif string.find(line, "^(.*) seems to glow faintly, his eyes gleaming with newfound energy.$") then
		person = string.match(line, "^(.*) seems to glow faintly, his eyes gleaming with newfound energy.$")
		echoEditor(RGBColourToName(styles[1].textcolour), RGBColourToName(styles[1].backcolour), line)
		notifyHighlight("USED DAYBREAK", person)
		
	else 
		Note("Error: Regex not found")
		Note(line)
	end
end
]]>
</script>
</muclient>